<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>python爬虫爬取前程无忧网岗位信息并存入excel数据表中</title>
      <link href="/2022/04/10/spider_51job/"/>
      <url>/2022/04/10/spider_51job/</url>
      
        <content type="html"><![CDATA[<h2 id="网页分析"><a href="#网页分析" class="headerlink" title="网页分析"></a>网页分析</h2><p>爬虫爬取数据首先要解析网页，要知道数据存放的地方，是直接写在dom节点中，还是写在script标签中又或者是通过JavaScript文件来获取并加载数据。<br>在前程无忧网<a href="https://www.51job.com/">https://www.51job.com</a>中搜索职位前端，ctrl+u进入网页源码，可以发现在dom节点中是找不到相关数据的，在源码中ctrl+f随便搜索看到的一家公司名字，如下图所示：<br><img src="https://img-blog.csdnimg.cn/578cb9a254184fc892302190bb05cdef.png"><br><img src="https://img-blog.csdnimg.cn/363fe6383afe4914be41b180a5e3e094.png"></p><p>可以发现数据全部存放在该源码中的一个<code>&lt;script type=&quot;text/javascript&quot;&gt;&lt;script&gt;</code>标签中，而非硬编码直接写在dom节点中，要获取数据也就是要获取到这个script标签，好了，网页分析就到这里，接下来直接上代码。</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 引入相关第三方依赖，如果没有安装则要提前安装</span><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> xlwt<span class="token keyword">import</span> re<span class="token keyword">import</span> ast<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse<span class="token comment"># 设置请求头</span>headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'Upgrade-Insecure-Requests'</span><span class="token punctuation">:</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Edg/87.0.664.57'</span><span class="token punctuation">,</span><span class="token string">'cookie'</span><span class="token punctuation">:</span><span class="token string">'acw_tc=2f624a2f16495828649574713e7ab28d88a4bf876df38cf588df9f39718913'</span><span class="token punctuation">&#125;</span><span class="token comment">#上面请求头所带的cookie如果过期了，就需要重新从浏览器上获取，然后更换代码中的cookie值</span><span class="token comment"># 输入岗位名称并转urlencode编码</span>job<span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入您要在前程无忧网爬取的岗位名称：'</span><span class="token punctuation">)</span>job_urlencode<span class="token operator">=</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token comment"># 创建ecxel文件，并在excel文件中新建一张工作表sheet1</span>workbook<span class="token operator">=</span>xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">'&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#设置工作表sheet1的列名及列宽</span><span class="token keyword">def</span> <span class="token function">ceate_sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'职位名称'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'公司名字'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'工资'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'地址'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'发布日期'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'公司性质'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'职位福利'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'行业'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'公司规模'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'投递链接'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'公司链接'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">20</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">30</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">10</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">60</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">20</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">30</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token comment">#获取数据并写入sheet1</span><span class="token keyword">def</span> <span class="token function">get_write_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  sheet1_row <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入要爬取&#123;&#125;岗位的页数：'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">'https://search.51job.com/list/000000,000000,0000,00,9,99,&#123;&#125;,2,&#123;&#125;.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare='</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job_urlencode<span class="token punctuation">,</span> i<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第&#123;&#125;页的链接是：&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">)</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>  <span class="token comment">#对url发起请求,获取Response对象</span>    response<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'gbk'</span>  <span class="token comment">#设置编码格式是gbk</span>    html_51job <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment">#解析获取到HTML</span>    job_script <span class="token operator">=</span> html_51job<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//script[@type="text/javascript"]'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text  <span class="token comment"># 获取存放数据的javascript</span>    job_script <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'"engine_jds":(.*),"jobid_count"'</span><span class="token punctuation">,</span> job_script<span class="token punctuation">)</span>  <span class="token comment"># 正则表达式提取数据</span>    job_text <span class="token operator">=</span> job_script<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 得到字符串形式的数据</span>    job_details <span class="token operator">=</span> ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">(</span>job_text<span class="token punctuation">)</span>  <span class="token comment"># 将字符串转为列表</span>        <span class="token comment"># 将数据循环写入sheet1</span>    <span class="token keyword">for</span> job_details_dict <span class="token keyword">in</span> job_details<span class="token punctuation">:</span>      <span class="token keyword">try</span><span class="token punctuation">:</span>        job_name <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'job_name'</span><span class="token punctuation">]</span>  <span class="token comment"># 职位名称</span>        company_name <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'company_name'</span><span class="token punctuation">]</span>  <span class="token comment"># 公司名字</span>        wages <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'providesalary_text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 工资</span>        address <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'workarea_text'</span><span class="token punctuation">]</span>  <span class="token comment"># 地址</span>        updatedate <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'updatedate'</span><span class="token punctuation">]</span>  <span class="token comment"># 发布日期</span>        companytype <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'companytype_text'</span><span class="token punctuation">]</span>  <span class="token comment"># 公司性质</span>        jobwelf <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'jobwelf'</span><span class="token punctuation">]</span>  <span class="token comment"># 职位福利</span>        company_status <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'companyind_text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 行业)</span>        companysize <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'companysize_text'</span><span class="token punctuation">]</span>  <span class="token comment"># 公司规模</span>        job_href <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'job_href'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 投递链接</span>        company_href <span class="token operator">=</span> job_details_dict<span class="token punctuation">[</span><span class="token string">'company_href'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 公司链接</span>        sheet1_row <span class="token operator">=</span> sheet1_row <span class="token operator">+</span> <span class="token number">1</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> job_name<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> company_name<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> wages<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> updatedate<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> companytype<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> jobwelf<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> company_status<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> companysize<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> job_href<span class="token punctuation">)</span>        sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> company_href<span class="token punctuation">)</span>      <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token string">''</span><span class="token keyword">def</span> <span class="token function">spider_51job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  ceate_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>  get_write_data<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#保存excel到该python文件的同一目录下</span>  workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'前程无忧网&#123;&#125;岗位.xls'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'爬取成功'</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------------------------'</span><span class="token punctuation">)</span>spider_51job<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>爬取结果部分截图如下：</p><p><img src="https://img-blog.csdnimg.cn/2ed39674e47f491d917d0cc5071956bf.png"></p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端插件swiper的基础使用</title>
      <link href="/2021/09/07/swiper-plug/"/>
      <url>/2021/09/07/swiper-plug/</url>
      
        <content type="html"><![CDATA[<h1 id="前端插件swiper的基础使用"><a href="#前端插件swiper的基础使用" class="headerlink" title="前端插件swiper的基础使用"></a>前端插件swiper的基础使用</h1><p>   很多网站都会使用轮播图，然而自己编写轮播图是一个比较繁琐的过程，在编写过程中要编写轮播图切换时间，切换按钮等等。在实际项目中要用到轮播图大可不用自己从零编写，只要会使用swiper这一款插件即可实现很多轮播特效。</p><h2 id="官网下载swiper"><a href="#官网下载swiper" class="headerlink" title="官网下载swiper"></a>官网下载swiper</h2><p>进入网站<a href="https://www.swiper.com.cn/download/index.html">https://www.swiper.com.cn/download/index.html</a> 下载相应版本的swiper文档。<br>博主在这里下载的是最新版本6.8.1,如下图所示：<img src="https://img-blog.csdnimg.cn/20f89deeedee4f29b0edf91ebba4f525.png"><br>下好之后解压即可得到名为swiper-master的文件夹。</p><h2 id="swiper使用"><a href="#swiper使用" class="headerlink" title="swiper使用"></a>swiper使用</h2><p>在<a href="https://www.swiper.com.cn/demo/index.html">https://www.swiper.com.cn/demo/index.html</a>查看自己想要的轮播图效果，博主在这里演示一下怎么把如下图所示的<a href="https://www.swiper.com.cn/demo/200-infinite-loop.html">Loop模式 / 无限循环(200)</a>用到自己的项目中。<img src="https://img-blog.csdnimg.cn/335da985b97542519cfe094638192c53.JPG"><br>在刚刚解压得到文件夹中有一个demos文件夹如下图：<br><img src="https://img-blog.csdnimg.cn/5068aec265444f94a8dae499d20b22be.png"><br>进入到demos文件夹，该文件夹里演示的就是官网上的效果，<a href="https://www.swiper.com.cn/demo/200-infinite-loop.html">Loop模式 / 无限循环(200)</a>的代号是200，在demos文件夹里找到200开头的html文件，如下图所示：<img src="https://img-blog.csdnimg.cn/3b12f2ba972447a0a0feec629b58437c.png"><br>在编辑器中打开该html文件，将该文件的代码复制到自己的html文件中，这里有个要注意的点，<strong>代码引用的css文件和js文件的路径要根据自己的路径情况来修改</strong>。<br>复制的代码中应用的css和js是这样的：</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>../package/swiper-bundle.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>../package/swiper-bundle.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>复制的代码中的css和js文件都放在swiper-maste文件夹中的package文件夹中，将css和js文件复制到自己的项目中，然后将引用路径修改为自己存放css和js的路径即可：</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css/swiper-bundle.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/swiper-bundle.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后运行自己的html文件就可以得到官图一样的效果了。</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Slide 10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将div里的元素改为自己要用于轮播的图片就可以了，博主在这里只使用了三张轮播图。</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>img/1.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>img/2.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swiper-slide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>img/3.jpg<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>如果图片规格不统一，比如有的图片尺寸大，有的尺寸小的话就可能会出现下图这样的情况：图片遮挡其他图片，或被其他图片遮挡。<br><img src="https://img-blog.csdnimg.cn/33d5ed06d8e64fca87f3142b3b8a9423.JPG"><br>可以给图片添加样式设置统一的宽高即可正常显示：</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">    <span class="token selector">.swiper-slide img</span><span class="token punctuation">&#123;</span>      <span class="token property">width</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>      <span class="token property">height</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后的效果放在了这里<a href="http://liubofeng.com/project/swiper-show/200-infinite-loop/">http://liubofeng.com/project/swiper-show/200-infinite-loop/</a><br>各位同学可以看看效果。<br>博主在这里只介绍了swiper的基本使用，没有深入介绍，想要深入了解的同学们可以看看<a href="https://www.swiper.com.cn/api/index.html">swiper的官方api文档</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
            <tag> swiper插件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python爬虫爬取实习僧岗位信息并存入excel数据表中</title>
      <link href="/2021/08/25/spider_sxs/"/>
      <url>/2021/08/25/spider_sxs/</url>
      
        <content type="html"><![CDATA[<p>博主在本博客中爬取的是数据分析岗位。</p><h2 id="网页分析"><a href="#网页分析" class="headerlink" title="网页分析"></a>网页分析</h2><p>进入网站首页<a href="https://www.shixiseng.com/">https://www.shixiseng.com/</a>搜索数据分析，F12审查元素，可以发现岗位的薪资以及其他用数字表示的信息都被加密了，如下图所示：<img src="https://img-blog.csdnimg.cn/ad5edc1780254bb6b38dbd38cc58094a.png#pic_center"></p><p>这也就意味着如果不破解字体加密，那么爬取到的薪资及其他数字数据将全部是上图中的乱码。</p><p>ctrl+u进入到网页源码，可以发现数据全是写在dom节点中的，那么只要破解字体加密再用xpath解析dom节点就可以爬取数据了。</p><p>F12审查元素，查看数字采用的哪一种字体：<br><img src="https://img-blog.csdnimg.cn/c3376c97f1814329b801892df85b9d0c.png"><br>从上图可以看到采用的是一种自定义字体：myFont<br>ctrl+u进入网页源码,ctrl+f在网页源码中搜索该字体: myFont，搜索结果如下图：<br><img src="https://img-blog.csdnimg.cn/30f4220145414cc8a33106e01c45ea73.png#pic_center"><br>从上图可以看到该字体文件的相对路径，将该路径与实习僧的域名拼接即可得到完整的字体路径:<code>www.shixiseng.com/interns/iconfonts/file?rand=0.12285263573042116</code><br>在浏览器中输入该路径就会下载一个名为file的文件，注意该文件是没有后缀名的，如下图：<br><img src="https://img-blog.csdnimg.cn/ff87759a59f146dd8622d4033b0d5dd7.png#pic_center"><br>将该文件重命名为file.ttf，然后将file.ttf文件移动到与你写的python文件的同一目录下，如下图所示，file.ttf文件与shixiseng.py文件都在实习僧_spider文件夹下，在同一目录下是为了方便在程序中使用file.ttf文件。</p><p><img src="https://img-blog.csdnimg.cn/2646785a535c42a8b39efb35794cbfcd.JPG#pic_center">在网页源码中，可以看到薪资被替换成了这样一串代码：<img src="https://img-blog.csdnimg.cn/9a2d0e2a65ed44ec8975a53a184123dd.JPG#pic_center"><br>&amp;#xf0c7&amp;#xe3c6&amp;#xe3f5-&amp;#xf0c7&amp;#xe7ec&amp;#xe3f5/天，与原网页对比就可以知道这串代码代表的是120-180/天。<br>现在要知道&amp;#xf0c7&amp;#xe3c6&amp;#xe3f5是怎么解码成120的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#将字体文件解析成xml文件</span><span class="token keyword">from</span> fontTools<span class="token punctuation">.</span>ttLib <span class="token keyword">import</span> TTFontfont <span class="token operator">=</span> TTFont<span class="token punctuation">(</span><span class="token string">"file.ttf"</span><span class="token punctuation">)</span>font<span class="token punctuation">.</span>saveXML<span class="token punctuation">(</span><span class="token string">"font.xml"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>在xml文件中搜索不到&amp;#xf0c7，&amp;#xe3c6，&amp;#xe3f5，但是可以搜到xf0c7，xe3c6，xe3f5，下图是包含xf0c7的代码，code是键，name是值。<br><img src="https://img-blog.csdnimg.cn/777f5e65b4784e8c9f5acb5dad8b5e2d.JPG#pic_center"><br>将name的值的uni后的字符31进行unicode解码,也就是对\u0031转中文得到1。<br>那么数字1的转换逻辑为&amp;#xf0c7=&gt;0xf0c7=&gt;uni31=&gt;\u0031=&gt;1</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>接下来直接上完整爬虫代码。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> xlwt<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> re<span class="token keyword">from</span> fontTools<span class="token punctuation">.</span>ttLib <span class="token keyword">import</span> TTFontfont <span class="token operator">=</span> TTFont<span class="token punctuation">(</span><span class="token string">"file.ttf"</span><span class="token punctuation">)</span>font<span class="token punctuation">.</span>saveXML<span class="token punctuation">(</span><span class="token string">"font.xml"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment">#打开并读取font.xml</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'font.xml'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        xml <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment">#正则表达式提取code和name</span>    keys <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'&lt;map code="(0x.*?)" name="uni.*?"/>'</span><span class="token punctuation">,</span> xml<span class="token punctuation">)</span>    values <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'&lt;map code="0x.*?" name="uni(.*?)"/>'</span><span class="token punctuation">,</span> xml<span class="token punctuation">)</span>    word_dict<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token comment"># 将name解码成中文并作为值写入字典word_dict，该字典的键为keys</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>            values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'\\u00'</span> <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'unicode_escape'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'\\u'</span> <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'unicode_escape'</span><span class="token punctuation">)</span>        word_dict<span class="token punctuation">[</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>word_dict<span class="token punctuation">)</span>    <span class="token keyword">return</span> word_dict<span class="token builtin">dict</span><span class="token operator">=</span>get_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#输入要爬取的岗位名称并转urlencode编码</span>job<span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入你要在实习僧爬取的实习岗位名称：'</span><span class="token punctuation">)</span>job_urlencode<span class="token operator">=</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">spider_sxs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment">#创建execl并设置列名</span>    workbook <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">'&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'职位名称'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'工资'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'城市'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'出勤要求'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'实习周期'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'职位福利'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'公司名称'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'所属行业'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'公司规模'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'投递链接'</span><span class="token punctuation">)</span>    sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'公司链接'</span><span class="token punctuation">)</span>    <span class="token comment"># 设置excel列宽度</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">30</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">20</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">10</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">60</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">20</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">20</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">15</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">30</span>    sheet1<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">256</span> <span class="token operator">*</span> <span class="token number">30</span>    sheet1_row<span class="token operator">=</span><span class="token number">0</span>    <span class="token comment"># 解析网页源代码</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入要爬取&#123;&#125;岗位的页数：'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        url<span class="token operator">=</span><span class="token string">'https://www.shixiseng.com/interns?page=&#123;&#125;&amp;type=intern&amp;keyword=&#123;&#125;&amp;area=&amp;months=&amp;days=&amp;degree=&amp;official=&amp;enterprise=&amp;salary=-0&amp;publishTime=&amp;sortType=&amp;city=%E5%85%A8%E5%9B%BD&amp;internExtend='</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>job_urlencode<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第&#123;&#125;页的链接是：&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>        response<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>        response_text<span class="token operator">=</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&amp;#'</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span>       <span class="token comment">#将源码中&amp;#xefed=>0xefed</span>        <span class="token keyword">for</span> key <span class="token keyword">in</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            response_text<span class="token operator">=</span>response_text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token comment">#0xefed格式=>对应的字典的值</span>        html_sxs<span class="token operator">=</span>etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response_text<span class="token punctuation">)</span>        all_div<span class="token operator">=</span>html_sxs<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="__layout"]/div/div[2]/div[2]/div[1]/div[1]/div[1]//div[@class="intern-wrap intern-item"]'</span><span class="token punctuation">)</span>        <span class="token comment"># 循环语句获取数据并存入excel</span>        <span class="token keyword">for</span> item <span class="token keyword">in</span> all_div<span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token comment"># 获取数据</span>                job_name <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//a[@class="title ellipsis font"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>       <span class="token comment">#职位名称</span>                wages <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="day font"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>      <span class="token comment">#工资</span>                city <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="city ellipsis"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>      <span class="token comment">#城市</span>                week_time <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="font"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>      <span class="token comment">#出勤要求</span>                work_time <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="font"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>      <span class="token comment">#实习周期</span>                job_welfare <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="company-label"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>       <span class="token comment">#职位福利</span>                company_name <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//a[@class="title ellipsis"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>       <span class="token comment">#公司名称</span>                company_type <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="ellipsis"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>       <span class="token comment">#所属行业</span>                company_size <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//span[@class="font"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>       <span class="token comment">#公司规模</span>                job_href <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//a[@class="title ellipsis font"]/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment">#投递链接</span>                company_href <span class="token operator">=</span> item<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'.//a[@class="title ellipsis"]/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>     <span class="token comment">#公司链接</span>                <span class="token comment"># 向execl写入数据</span>                sheet1_row<span class="token operator">=</span>sheet1_row<span class="token operator">+</span><span class="token number">1</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>job_name<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>wages<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>city<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>week_time<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>work_time<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>job_welfare<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span>company_name<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span>company_type<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>company_size<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>job_href<span class="token punctuation">)</span>                sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>sheet1_row<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>company_href<span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                <span class="token string">''</span>    workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'实习僧&#123;&#125;岗位.xls'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'爬取成功'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------------------------'</span><span class="token punctuation">)</span>spider_sxs<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>爬取结果部分截图如下：<br><img src="https://img-blog.csdnimg.cn/1d84e16a8d534e76a25f1d85fadcffe6.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_Q1NETiBA5piv5YWt5pyI,size_78,color_FFFFFF,t_70,g_se,x_16#pic_center"></p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 字体反爬 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
